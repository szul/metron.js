var Metron={};Metron.Class={extend:function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)},clone:function(t){function e(){}return e.prototype=t,new e},mixin:function(t,e){for(var n in e.prototype)null!==e.prototype[n]&&"undefined"==typeof t.prototype[n]&&(t.prototype[n]=e.prototype[n])}},Metron.AJAX=function(){function t(){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLHTTP");try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}}return t}return{createHTTPClient:function(e,n){if(n=n||{},"undefined"!=typeof n.method&&(n.method=n.method.toUpperCase()),n.data&&"object"==typeof n.data){var r=[];for(var o in n.data)"undefined"!=typeof n.data[o]&&r.push(o+"="+encodeURI(n.data[o]));n.data=r.join("&")}var i;if(!n.type||"jsonp"!==n.type.trim().toLowerCase()&&"json"!==n.type.trim().toLowerCase()&&"xml"!==n.type.trim().toLowerCase()||(i=n.type.trim().toLowerCase()),document&&"jsonp"===i){var s;if("undefined"==typeof n.onsuccess)throw"Error: No 'onsuccess' callback specified.";var a="jsonp"+Metron.GUID.newGuid().replace(/-/g,"_"),c=document.getElementsByTagName("head");window[a]=function(t){s=t};var p=document.createElement("script");p.setAttribute("type","text/javascript");var u=!1;p.onload=p.onreadystatechange=function(){if(!(u||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)){u=!0;var t={readyState:4},e=JSON.stringify(s);"undefined"==typeof e||null===e||""===e.trim()?t.status=500:(t.status=200,t.responseJSON=s,t.responseText=e),n.onsuccess(t);try{p.onload=p.onreadystatechange=null,c&&p.parentNode&&c.removeChild(p)}catch(r){}}},p.setAttribute("src",e+"?"+n.data+"&callback="+a),c.length>0&&c[0].appendChild(p)}else{var l=t();l&&(l.open("undefined"!=typeof n.method?n.method:"GET",e,"undefined"!=typeof n.async?n.async:!0),l.onreadystatechange=function(){if(4===l.readyState){if(200===l.status&&"undefined"!=typeof n.onsuccess){if("json"===i)try{l.responseJSON=Metron.JSON.parse(l.responseText)}catch(t){}if("xml"===i)try{l.responseXML=Metron.XML.load(requeste.responseText)}catch(e){}n.onsuccess(l)}(404===l.status||500===l.status)&&"undefined"!=typeof n.onfailure&&n.onfailure(l)}},"undefined"!=typeof n.method&&"POST"==n.method&&l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),l.send(n.data))}}}}(),Metron.Web={querystring:{get:function(t){for(var e,n=[],r=new RegExp("(?:\\?|&)"+t+"=(.*?)(?=&|$)","gi");null!=(e=r.exec(document.location.search));)n.push(e[1]);return n}}},Metron.Observer=function(){function t(t){n=setInterval(function(){t.onTimer(t)},1e3*e)}var e,n;return{watch:function(e,n){e=e,n=n,t(this)},stop:function(){n&&(clearInterval(n),n=null)}}}(),Metron.GUID=function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return{newGuid:function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}}(),Metron.IO={},Metron.IO.File={read:function(t){var e;try{var n=new ActiveXObject("Scripting.FileSystemObject"),r=n.OpenTextFile(Metron.IO.File.formatUnixPath(t),1);e=r.ReadAll(),r.close()}catch(o){throw"Error: Unable to open file: "+o}return e},formatUnixPath:function(t){return t.replace(/\\/g,"/")},formatWindowsPath:function(t){return t.replace(/\//g,"\\")}},Metron.Template={load:function(t,e,n){var r;if("undefined"==typeof n&&(n=!0),n&&Metron.Template.Cache.exists(t)&&(r=Metron.Template.Cache.find(t)),"undefined"==typeof r)try{Metron.AJAX.createHTTPClient(t,{onsuccess:function(t){r=t.responseText},onfailure:function(){throw"Error: Unable to load file: "+t},async:!1,method:"GET"})}catch(o){r=Metron.IO.File.read(t)}n&&!Metron.Template.Cache.exists(t)&&Metron.Template.Cache.insert(t,r);for(var i in e)if("undefined"!=typeof e[i]){var s="{{"+i+"}}";r=r.replace(s,e[i])}return r}},Metron.Template.Cache=function(){var t={};return{insert:function(e,n){t[e]=n},remove:function(e){t[e]=null},find:function(e){return t[e]},exists:function(e){return null!==t[e]?!0:!1},precache:function(t){for(var e=0;e<t.length;e++)Metron.Template.Cache.exists(t[e])||Metron.Template.load(t[e],null)}}}(),"undefined"==typeof $m&&($m=Metron,$m.loadTemplate=function(t,e){return Metron.Template.load(t,e)},$m.querystring=function(t){return Metron.Web.querystring.get(t)}),"undefined"==typeof extend&&(extend=Metron.Class.extend),"undefined"==typeof clone&&(clone=Metron.Class.clone),"undefined"==typeof mixin&&(mixin=Metron.Class.mixin),String.prototype.lower=function(){return this.toLowerCase()},String.prototype.upper=function(){return this.toUpperCase()},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},String.prototype.normalize=function(){return this.replace(/^\s*|\s(?=\s)|\s*$/g,"")},String.prototype.startsWith=function(t){return this.slice(0,t.length)==t},String.prototype.endsWith=function(t){return this.slice(-t.length)==t},String.prototype.capFirst=function(){if(1==this.length)return this.toUpperCase();if(this.length>0){var t=/^(\(|\[|"|')/;return t.test(this)?this.substring(0,2).toUpperCase()+this.substring(2):this.substring(0,1).toUpperCase()+this.substring(1)}return null},String.prototype.capWords=function(){var t=/\s/,e=this.split(t);if(1==e.length)return e[0].capFirst();if(e.length>1){for(var n="",r=0;r<e.length;r++)null!=e[r].capFirst()&&(n+=e[r].capFirst()+" ");return n.trim(),n}return null},String.prototype.truncateWords=function(t){var e=this.split(/\s+/);return e.length>t?e.slice(0,t).join(" "):e.join(" ")},String.prototype.truncateWordsWithHtml=function(t){for(var e=[],n=this.truncateWords(t),r=n.match(/<[\/]?([^> ]+)[^>]*>/g),o=0;o<r.length;o++){var i=r[o].replace("/","");if(-1!=r[o].indexOf("/")&&-1!=e.indexOf(i))e.remove(i);else{if(-1!=r[o].indexOf("/"))continue;e.push(r[o])}}for(var s=0;s<e.length;s++)n+=e[s].replace("<","</").replace(/(\s*)(\w+)=("[^<>"]*"|'[^<>']*'|\w+)/g,"");return n},String.prototype.stripHtml=function(){var t=this.replace(/<[\/]?([^> ]+)[^>]*>/g,"");return t=t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,""),t=t.replace(/<script[^>]*>[\s\S]*?<\/script>/gi,""),t=t.replace(/<!--[\s\S]*?-->/g,""),t=t.replace("&nbsp;"," "),t=t.replace("&amp;","&")},String.prototype.escapeHtml=function(){var t=this.replace(/"/g,"&quot;");return t.replace(/&(?!\w+;)/g,"&amp;"),t.replace(/>/g,"&gt;"),t.replace(/</g,"&lt;"),t},String.prototype.toPhoneNumber=function(){try{return this.substring(0,3)+"-"+this.substring(3,6)+"-"+this.substring(6)}catch(t){return this}},Array.prototype.empty=function(){return this.splice(0,this.length)},Array.prototype.isEmpty=function(){return 0===this.length?!0:!1},Array.prototype.each=function(t){for(var e=0;e<this.length;e++)t(this[e],e)},Array.prototype.remove=function(t){var e=this.indexOf(t);-1!=e&&this.splice(e,1)},Array.prototype.toObjectArray=function(t){if(null==t)throw"Property name must be provided for conversion.";var e=this;if("string"==typeof e[0]||"number"==typeof e[0]||"boolean"==typeof e[0]){for(var n=0;n<e.length;n++){var r=e[n];e[n]={},e[n][t]=r}return e}return this};
